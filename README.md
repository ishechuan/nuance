# Nuance ğŸ¯

**AI-powered English Learning Assistant** â€” Extract, Analyze, Master

Nuance æ˜¯ä¸€æ¬¾æ™ºèƒ½è‹±è¯­å­¦ä¹ æµè§ˆå™¨æ‰©å±•ï¼Œå¸®åŠ©ä½ ä»ä»»ä½•è‹±æ–‡ç½‘é¡µä¸­æå–å¹¶å­¦ä¹ æœ‰ä»·å€¼çš„è¯­è¨€çŸ¥è¯†ç‚¹ã€‚

![WXT](https://img.shields.io/badge/WXT-0.20-blue)
![React](https://img.shields.io/badge/React-19-61DAFB)
![TypeScript](https://img.shields.io/badge/TypeScript-5.9-3178C6)
![License](https://img.shields.io/badge/License-MIT-green)

## âœ¨ åŠŸèƒ½ç‰¹ç‚¹

### ğŸ” æ™ºèƒ½å†…å®¹æå–

- ä½¿ç”¨ [Mozilla Readability](https://github.com/mozilla/readability) è‡ªåŠ¨æå–ç½‘é¡µæ­£æ–‡
- è¿‡æ»¤å¹¿å‘Šã€å¯¼èˆªç­‰å¹²æ‰°å†…å®¹ï¼Œä¸“æ³¨äºæ ¸å¿ƒæ–‡ç« 

### ğŸ¤– AI æ·±åº¦åˆ†æ

åŸºäº DeepSeek AI å¯¹æ–‡æœ¬è¿›è¡Œä¸‰ç»´åº¦è¯­è¨€åˆ†æï¼š

| ç±»åˆ«         | è¯´æ˜                                 | ç¤ºä¾‹                                     |
| ------------ | ------------------------------------ | ---------------------------------------- |
| **ä¹ æƒ¯ç”¨æ³•** | åœ°é“ä¹ è¯­ã€çŸ­è¯­åŠ¨è¯ã€å›ºå®šæ­é…         | "running out of time", "make a decision" |
| **æ ¸å¿ƒè¯­æ³•** | å€’è£…å¥ã€è™šæ‹Ÿè¯­æ°”ã€å®šè¯­ä»å¥ç­‰è¿›é˜¶å¥å‹ | åˆ†è¯çŸ­è¯­ã€å¼ºè°ƒå¥                         |
| **æ ¸å¿ƒè¯æ±‡** | B1-C2 çº§åˆ«è¯æ±‡ï¼Œå«ä¸­æ–‡é‡Šä¹‰å’Œè¯­å¢ƒ     | æŒ‰éš¾åº¦ç­‰çº§æ ‡æ³¨                           |

### ğŸ¨ ç°ä»£åŒ–ç•Œé¢

- ç®€æ´ä¼˜é›…çš„ä¾§è¾¹æ è®¾è®¡
- åˆ†ç±»æ ‡ç­¾é¡µå¿«é€Ÿåˆ‡æ¢
- ç‚¹å‡»å¡ç‰‡é«˜äº®åŸæ–‡å®šä½

### ğŸ“ æ™ºèƒ½é«˜äº®

- ä¸€é”®å®šä½ï¼šç‚¹å‡»åˆ†æå¡ç‰‡ï¼Œè‡ªåŠ¨åœ¨ç½‘é¡µä¸­é«˜äº®å¯¹åº”å¥å­
- å¹³æ»‘æ»šåŠ¨åˆ°ç›®æ ‡ä½ç½®
- æŸ”å’Œçš„é«˜äº®åŠ¨ç”»æ•ˆæœ

## ğŸ“¦ å®‰è£…

### å‰ç½®è¦æ±‚

- Node.js 18+
- pnpm (æ¨è) æˆ– npm

### å®‰è£…ä¾èµ–

```bash
pnpm install
```

### å¼€å‘æ¨¡å¼

```bash
# Chrome
pnpm dev

# Firefox
pnpm dev:firefox
```

è¿è¡Œåä¼šè‡ªåŠ¨æ‰“å¼€å¸¦æœ‰æ‰©å±•çš„ Chrome/Firefox æµè§ˆå™¨ã€‚

### ç”Ÿäº§æ„å»º

```bash
# Chrome
pnpm build

# Firefox
pnpm build:firefox
```

æ„å»ºäº§ç‰©ä½äº `.output/chrome-mv3` æˆ– `.output/firefox-mv3`ã€‚

### æ‰“åŒ…å‘å¸ƒ

```bash
# Chrome
pnpm zip

# Firefox
pnpm zip:firefox
```

## ğŸš€ ä½¿ç”¨æŒ‡å—

### 1. é…ç½® API Key

1. ç‚¹å‡»æ‰©å±•å›¾æ ‡æ‰“å¼€ä¾§è¾¹æ 
2. ç‚¹å‡»å³ä¸Šè§’ âš™ï¸ è®¾ç½®æŒ‰é’®
3. è¾“å…¥ä½ çš„ [DeepSeek API Key](https://platform.deepseek.com/api_keys)
4. ç‚¹å‡»ä¿å­˜

> ğŸ’¡ DeepSeek API ä»·æ ¼å®æƒ ï¼Œéå¸¸é€‚åˆä¸ªäººå­¦ä¹ ä½¿ç”¨

### 2. åˆ†ææ–‡ç« 

1. æ‰“å¼€ä»»æ„è‹±æ–‡æ–‡ç« é¡µé¢ï¼ˆæ–°é—»ã€åšå®¢ã€è®ºæ–‡ç­‰ï¼‰
2. ç‚¹å‡»æµè§ˆå™¨å·¥å…·æ ä¸­çš„ Nuance å›¾æ ‡
3. åœ¨ä¾§è¾¹æ ä¸­ç‚¹å‡» **"Analyze Page"** æŒ‰é’®
4. ç­‰å¾… 10-30 ç§’ï¼ŒAI å°†å®Œæˆæ·±åº¦åˆ†æ

### 3. å­¦ä¹ å†…å®¹

- **Idioms** æ ‡ç­¾ï¼šæŸ¥çœ‹ä¹ æƒ¯ç”¨æ³•å’Œå›ºå®šæ­é…
- **Syntax** æ ‡ç­¾ï¼šå­¦ä¹ å¤æ‚å¥å‹ç»“æ„
- **Vocabulary** æ ‡ç­¾ï¼šæŒæ¡æ ¸å¿ƒè¯æ±‡

ç‚¹å‡»ä»»æ„å¡ç‰‡ï¼ŒåŸæ–‡ä¸­å¯¹åº”å†…å®¹ä¼šè¢«é«˜äº®æ˜¾ç¤ºå¹¶è‡ªåŠ¨æ»šåŠ¨åˆ°è§†é‡å†…ã€‚

## ğŸ› ï¸ æŠ€æœ¯æ¶æ„

```
nuance-extension/
â”œâ”€â”€ entrypoints/
â”‚   â”œâ”€â”€ background.ts      # Service Worker - API è°ƒç”¨ã€æ¶ˆæ¯è·¯ç”±
â”‚   â”œâ”€â”€ content.ts         # Content Script - å†…å®¹æå–ã€é«˜äº®åŠŸèƒ½
â”‚   â””â”€â”€ sidepanel/         # ä¾§è¾¹æ  React åº”ç”¨
â”‚       â”œâ”€â”€ App.tsx        # ä¸»ç»„ä»¶
â”‚       â”œâ”€â”€ index.html     # ä¾§è¾¹æ  HTML å…¥å£
â”‚       â”œâ”€â”€ main.tsx       # React æŒ‚è½½å…¥å£
â”‚       â”œâ”€â”€ components/    # UI ç»„ä»¶
â”‚       â””â”€â”€ styles.css     # æ ·å¼æ–‡ä»¶
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ messages.ts        # æ¶ˆæ¯ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ prompts.ts         # AI Prompt æ¨¡æ¿
â”‚   â””â”€â”€ storage.ts         # å­˜å‚¨ç®¡ç†
â”œâ”€â”€ public/
â”‚   â””â”€â”€ icon/              # æ‰©å±•å›¾æ ‡
â”œâ”€â”€ landing/               # äº§å“è½åœ°é¡µï¼ˆæœ¬åœ°é¢„è§ˆï¼‰
â””â”€â”€ wxt.config.ts          # WXT é…ç½®
```

### æ ¸å¿ƒæŠ€æœ¯æ ˆ

- **[WXT](https://wxt.dev/)** - ç°ä»£æµè§ˆå™¨æ‰©å±•å¼€å‘æ¡†æ¶
- **React 19** - UI æ¡†æ¶
- **TypeScript** - ç±»å‹å®‰å…¨
- **Mozilla Readability** - ç½‘é¡µæ­£æ–‡æå–
- **DeepSeek API** - AI æ–‡æœ¬åˆ†æ

### æ‰©å±•æƒé™

| æƒé™        | ç”¨é€”                    |
| ----------- | ----------------------- |
| `storage`   | å­˜å‚¨ API Key å’Œåˆ†æå†å² |
| `activeTab` | è®¿é—®å½“å‰æ ‡ç­¾é¡µå†…å®¹      |
| `sidePanel` | æ˜¾ç¤ºä¾§è¾¹æ ç•Œé¢          |

## ğŸ“‹ NPM Scripts

| å‘½ä»¤                 | è¯´æ˜                    |
| -------------------- | ----------------------- |
| `pnpm dev`           | å¯åŠ¨ Chrome å¼€å‘æœåŠ¡å™¨  |
| `pnpm dev:firefox`   | å¯åŠ¨ Firefox å¼€å‘æœåŠ¡å™¨ |
| `pnpm build`         | æ„å»º Chrome ç”Ÿäº§ç‰ˆæœ¬    |
| `pnpm build:firefox` | æ„å»º Firefox ç”Ÿäº§ç‰ˆæœ¬   |
| `pnpm zip`           | æ‰“åŒ… Chrome æ‰©å±•        |
| `pnpm zip:firefox`   | æ‰“åŒ… Firefox æ‰©å±•       |
| `pnpm compile`       | TypeScript ç±»å‹æ£€æŸ¥     |
| `pnpm landing`       | æœ¬åœ°é¢„è§ˆ landing é¡µé¢   |

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

é¡¹ç›®æ”¯æŒå¤šç¯å¢ƒé…ç½®ï¼ŒæŒ‰ä¼˜å…ˆçº§åŠ è½½ï¼š

```
.env.development.chrome.local  # å¼€å‘ç¯å¢ƒ Chrome æœ¬åœ°é…ç½®
.env.development.chrome        # å¼€å‘ç¯å¢ƒ Chrome é…ç½®
.env.chrome.local              # Chrome æœ¬åœ°é…ç½®
.env.chrome                    # Chrome é…ç½®
.env.development.local         # å¼€å‘ç¯å¢ƒæœ¬åœ°é…ç½®
.env.development               # å¼€å‘ç¯å¢ƒé…ç½®
.env.local                     # æœ¬åœ°é…ç½®
.env                           # é€šç”¨é…ç½®
```

### WXT é…ç½®

æŸ¥çœ‹ `wxt.config.ts` äº†è§£å®Œæ•´é…ç½®ï¼š

```ts
export default defineConfig({
  modules: ["@wxt-dev/module-react"],
  manifest: {
    name: "Nuance",
    description: "AI-powered English learning assistant",
    permissions: ["storage", "activeTab", "sidePanel"],
    // ...
  },
});
```

## ğŸ“š API æ–‡æ¡£

### æ¶ˆæ¯é€šä¿¡

- æ¶ˆæ¯ç±»å‹ä¸è½½è·

  - `EXTRACT_CONTENT`: ä»å†…å®¹è„šæœ¬æå–æ­£æ–‡ï¼Œå“åº”åŒ…å« `title | content | textContent | url`
  - `ANALYZE_TEXT`: åå°è°ƒç”¨ DeepSeek è¿›è¡Œåˆ†æï¼Œå“åº”ä¸º `AnalysisResult`
  - `HIGHLIGHT_TEXT`: åœ¨é¡µé¢ä¸­é«˜äº®æŒ‡å®šæ–‡æœ¬ï¼Œå“åº”åŒ…å« `found`
  - `CLEAR_HIGHLIGHTS`: æ¸…é™¤é¡µé¢æ‰€æœ‰é«˜äº®

- äº¤äº’åºåˆ—

```
Sidepanel -> Background: EXTRACT_CONTENT
Background -> Content: EXTRACT_CONTENT
Content -> Background: ExtractContentResponse
Background -> Sidepanel: ExtractContentResponse

Sidepanel -> Background: ANALYZE_TEXT
Background -> DeepSeek API: POST /chat/completions
DeepSeek API -> Background: JSON (AnalysisResult)
Background -> Sidepanel: AnalyzeTextResponse

Sidepanel -> Background: HIGHLIGHT_TEXT
Background -> Content: HIGHLIGHT_TEXT
Content -> Background: HighlightTextResponse
Background -> Sidepanel: HighlightTextResponse
```

### ä»£ç ç¤ºä¾‹

æå–ä¸åˆ†æï¼š

```ts
const extract = await browser.runtime.sendMessage({ type: "EXTRACT_CONTENT" });
const analyze = await browser.runtime.sendMessage({
  type: "ANALYZE_TEXT",
  text: extract.data!.textContent,
});
```

é«˜äº®ä¸æ¸…é™¤ï¼š

```ts
await browser.runtime.sendMessage({ type: "CLEAR_HIGHLIGHTS" });
await browser.runtime.sendMessage({ type: "HIGHLIGHT_TEXT", text: someText });
```

### DeepSeek æ¥å£

- ç«¯ç‚¹ï¼š`POST https://api.deepseek.com/chat/completions`
- æ¨¡å‹ï¼š`deepseek-chat`
- è¯·æ±‚ä½“ç¤ºä¾‹ï¼š

```json
{
  "model": "deepseek-chat",
  "messages": [
    { "role": "system", "content": "<ç³»ç»Ÿæç¤ºè¯>" },
    { "role": "user", "content": "<æ„é€ åçš„åˆ†ææç¤ºè¯>" }
  ],
  "temperature": 0.3,
  "response_format": { "type": "json_object" }
}
```

- å“åº”æ•°æ®ï¼šä» `choices[0].message.content` è§£æä¸º JSONï¼Œç»“æ„å¦‚ä¸‹ï¼š

```json
{
  "idioms": [{ "expression": "", "meaning": "", "example": "" }],
  "syntax": [{ "sentence": "", "structure": "", "explanation": "" }],
  "vocabulary": [{ "word": "", "level": "B1", "definition": "", "context": "" }]
}
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. æäº¤ Pull Request
